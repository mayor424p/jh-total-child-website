{% extends 'pages/base.html' %}

{% block content %}

<div class="container my-5 dashboard">

  <!-- Dashboard Header -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h2 class="dashboard-title">Admin Dashboard</h2>
      <p class="dashboard-subtitle">Manage your website content and applications</p>
    </div>
  </div>

  <!-- Tabs -->
  <ul class="nav nav-tabs mb-4 dashboard-tabs">
    <li class="nav-item">
      <a class="nav-link {% if tab == 'gallery' %}active{% endif %}" href="?tab=gallery">
        Gallery Images <span class="badge bg-primary">{{ images.count }}</span>
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link {% if tab == 'applications' %}active{% endif %}" href="?tab=applications">
        Applications <span class="badge bg-primary">{{ applications.count }}</span>
      </a>
    </li>
  </ul>

  <!-- Applications Tab -->
  {% if tab == 'applications' %}

 

  <div class="row mb-4 dashboard-stats text-center g-3">
    <div class="col-md-4">
      <div class="card stat-card border-primary p-3">
        <h5>Pending</h5>
        <span class="stat-count text-warning">{{ pending_count }}</span>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card stat-card border-success p-3">
        <h5>Approved</h5>
        <span class="stat-count text-success">{{ approved_count }}</span>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card stat-card border-danger p-3">
        <h5>Rejected</h5>
        <span class="stat-count text-danger">{{ rejected_count }}</span>
      </div>
    </div>

  </div>

  <!-- Applications List -->
  <div class="row g-3">
    {% for app in applications %}
    <div class="col-md-6 col-lg-4">
      <div class="card application-card p-3 shadow-sm">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <strong>{{ app.surname }} {{ app.other_names }}</strong>
          <span class="badge status-badge {{ app.status }}">{{ app.status|title }}</span>
        </div>
        <p class="mb-1"><strong>Phone:</strong> {{ app.father_phone }}</p>
        <p class="mb-1"><strong>Email:</strong> {{ app.father_email }}</p>
        <small class="text-muted">Submitted: {{ app.submitted_at }}</small>

        <div class="mt-3 d-flex justify-content-between application-actions">
          <a href="{% url 'dashboard:approve' app.id %}" class="btn btn-sm btn-success">Approve</a>
          <a href="{% url 'dashboard:reject' app.id %}" class="btn btn-sm btn-warning">Reject</a>
          <a href="{% url 'dashboard:delete_application' app.id %}" class="btn btn-sm btn-danger">Delete</a>
          <a href="{% url 'dashboard:application_detail' app.pk %}" class="btn btn-sm btn-outline-primary">View Details</a>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
  {% endif %}

  <!-- Gallery Tab -->
  {% if tab == 'gallery' %}
  <div class="mb-4">
    <a href="{% url 'dashboard:add_image' %}" class="btn btn-primary">+ Add New Image</a>
  </div>

  <div class="row g-3 gallery-grid">
    {% for img in images %}
    <div class="col-sm-6 col-md-4 col-lg-3">
      <div class="card image-card shadow-sm">
        <img src="{{ img.image.url }}" class="card-img-top" alt="{{ img.title }}">
        <div class="card-body">
          <h5 class="card-title">{{ img.title }}</h5>
          <p class="card-text"><small class="text-muted">{{ img.created_at|date:"M d, Y" }}</small></p>
          <a href="{% url 'dashboard:delete_image' img.id %}" class="btn btn-sm btn-danger">Delete</a>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
  {% endif %}

</div>

{% endblock %}
